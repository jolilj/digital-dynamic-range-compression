\documentclass[]{article}
\usepackage{natbib}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\usepackage{textcomp}
\usepackage{pgfplots}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amsmath}

\begin{document}

\title{Digital dynamic range compression algorithm design att KlevgrÃ¤nd Production AB}
\author{J. Lilja, O. Karlsson}
\date{2014-02-01}
\maketitle

\begin{abstract}
In this study/paper/report, we investigate...
\end{abstract}

\clearpage
\section{Introduction}
\section{Background}
\subsection{Dynamical range compression}
The dynamic range compressor is a complex nonlinear time dependent system where the the amplitude peaks of a signal is suppressed, reducing its dynamic range. The complexity of the system together with the vast set of design choices makes it difficult to draw a generic block diagram of the process\cite{giannoullis}  and thus we will, in the analysis, focus on a digital implementation corresponding to ideal components of it's analogue counterpart. 

In figure \ref{fig:xy-graph} the eligible behaviour of a simple compression process is illustrated. The x- and y-axis represents the logarithmic amplitude of input and output signal respectively. As the input signal rise above the threshold level, compression is applied. Logarithmic scale is used since sound amplitude is, by standard, expressed in the logarithmic unit decibel.

In practice, however, is is not desirable to apply instant compression since it introduces distortion\cite{giannoullis}. We thus want to smooth out the compression applied over time. This is illustrated in figure \ref{fig:envelope-graph}.

%\begin{figure}[ht]
%\captionsetup{justification=centering}
%\begin{minipage}[t]{.5\textwidth}
% \centering
%\input{XY-graph}
%\caption{Output signal vs input signal.} 
%\label{fig:xy-graph}
%\end{minipage}%
%\begin{minipage}[t]{.5\textwidth}
%\centering
%\input{envelope}
%\caption{Input and output signal plotted over time. } 
%\label{fig:envelope-graph}
%\end{minipage}
%\end{figure}

In order to analyse the compression process we define the following parameters
\begin{itemize}
\item{\textbf{Threshold} - The defined limit above which compression is applied }
\item{\textbf{Ratio} - The input/output ratio above the threshold level. Determines the amount of compression}
\item{\textbf{Attack time} - Determines how quickly the compression ratio is applied.}
\item{\textbf{Release time} - Determines how quickly the compression is released as the input signal drops below the threshold level.}
\item{\textbf{Knee width} - Controls the sharpness of the knee, see figure \ref{fig:xy-graph}.}
\end{itemize}



\subsection{Gain-reduction}
We begin our derivation of a block diagram for a generic compressor with the gain reduction step. This is where the signals amplitude is modified and is achieved with a \emph{Voltage Controlled Amplifier} (VCA).

In the analog history of compressor design, various different circuit types have been implemented for this task (FET, optical circuits, tube amplifiers etc.), each with it's own characteristic. In this paper we will use the term VCA as a generic term for any controllable amplifier. This is not to be confused with modern solid state compressors that use integrated VCA circuits for gain control, sometimes called \emph{VCA compressors}.


\begin{figure}[ht]
\centering
\input{vca-generic-blockdiagram}
\caption{Block diagram of gain reduction step} 
\label{fig:vca-generic-blockdiagram}
\end{figure}





\subsection{Feed-forward, feedback}
Now, we stand at an early cross-road for how to compute the control voltage. We can choose to have an open loop, feed-forward design, or a closed loop, feedback design.

\begin{figure}[ht]
\centering
\input{feedforward-blockdiagram}
\caption{Block diagram of feed forward design} 
\label{fig:feedforward-blockdiagram}
\end{figure}

\begin{figure}[ht]
\centering
\input{feedback-blockdiagram}
\caption{Block diagram of feedback design} 
\label{fig:feedback-blockdiagram}
\end{figure}

\subsection{Gain computer}
According to figure \ref{fig:xy-graph} and denoting the threshold level $T$ and the ratio $R$, we get
\begin{equation} \label{eq:gaincomp}
Y = \left\{ 
  \begin{array}{l l}
    T+ \dfrac{X-T}{R} & \quad \text{if $X > T$}\\
    X & \quad \text{otherwise.}
  \end{array} \right.
\end{equation}
\\Modelling an ideal VCA using the exponential of the control voltage, $c$, yields
\begin{align}
y &= xe^{c}   \\
\log|y| & = \log|x| + c   \\
Y &= X + c \label{eq:cv}
\end{align}
\\Negative control voltage corresponds to compression while zero control voltage leaves the input signal uncompressed. 

In a feedback design the control voltage is a function of the output signal and thus equation (\ref{eq:cv}) and (\ref{eq:gaincomp}) yields
\begin{equation}
Y = \left\{ 
  \begin{array}{l l}
    T+ \dfrac{Y-c-T}{R} & \quad \text{if $X > T$}\\
    Y-c & \quad \text{otherwise.}
  \end{array} \right.
\end{equation}
\\Solving for $c \rm \Rightarrow$
\begin{equation} \label{eq:c}
c = \left\{ 
  \begin{array}{l l}
    (1-R)(Y-T)& \quad \text{if $Y-c > T$}\\
    0 & \quad \text{otherwise.}
  \end{array} \right.
\end{equation}
\\Rewrite the limit for $c$
\begin{align*}
Y - c  = Y-(1-R)(Y-T) = T + R(Y-T) > T.   \\
\end{align*}
\\Hence 
\begin{align*}
Y-c > T \Longleftrightarrow R(Y-T)  > 0.
\end{align*}
\\And assuming $R > 0$
\begin{align} \label{eq:feedbacklimit}
Y > T.
\end{align}
\\Inserting equation (\ref{eq:feedbacklimit}) into (\ref{eq:c}) allow us to write the control voltage as
\begin{align}
c = (1-R)\cdot ma\left(Y-T,0\right)
\end{align}
\\In the case of a ideal limiter ($R = \infty$) an infinite negative amplification is needed to calculate the control voltage. A perfect limiter is thus impossible to implement with a feedback design.
\bibliographystyle{plain}
\bibliography{reflist}
\end{document}